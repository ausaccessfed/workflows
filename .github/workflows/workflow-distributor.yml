name: "Distribute Workflows"
on:
  workflow_dispatch:
  # TODO: disable push
  push:
jobs:
  distribution:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    steps:
      - name: Checkout
        uses: actions/checkout@f43a0e5ff2bd294095638e18286ca9a3d1956744 # v3.6.0

      - uses: actions/github-script@d7906e4ad0b1822421a7e6a35d5ca353c962f410 # v6.4.1
        with:
          github-token: ${{secrets.ALL_REPO_SCOPED_TOKEN}}
          script: |
            const fs = require('fs')
            const {
                repo: {
                    owner,
                    repo
                }
            } = context
            const repos = ${{ vars.RENOVATE_REPOSITORIES }}
            console.log(repos)
            const globber = await glob.create('**/**/distributions/*.yml', {followSymbolicLinks: false})
            const files = await globber.glob()
            console.log(files)

            for(let i = 0;i++;i < files.length) {
              const fileContents = fs.readFileSync(files[i])
              console.log(fileContents)

              //for(const repo in repos) {
                //await github.rest.pulls.create({
                //  owner,
                //  repo,
                //  title: "Updating Common Workflows",
                // body: 
                //})
              //}
            }
