name: 'Todo processor'
description: 'expected to be used in a pr context'
inputs:
  GITHUB_TOKEN:
    description: 'github token used to auth to api'
    default: ''
  GPG_PRIVATE_KEY:
    description: 'GPG key to sign commits with'
    required: true
runs:
  using: 'composite'
  steps:
    - uses: ausaccessfed/workflows/.github/actions/branch_finder@main
      id: branch
      with:
        EVENT_NAME: ${{ github.event_name }}
    - uses: ausaccessfed/workflows/.github/actions/init@main
      with:
        FETCH_DEPTH: '0'
        BRANCH_NAME: ${{ steps.branch.outputs.BRANCH_NAME }}
    - name: 'TODO to Issue'
      uses: 'alstr/todo-to-issue-action@973393389c53206cc1f317f9ae6d316ec1ac5f93' # v5.1.10
      with:
        INSERT_ISSUE_URLS: 'true'
        CLOSE_ISSUES: 'true'
        TOKEN: ${{ inputs.GITHUB_TOKEN }}
    - uses: ausaccessfed/workflows/.github/actions/committer@main
      with:
        GITHUB_TOKEN: ${{ inputs.GITHUB_TOKEN }}
        GITHUB_ACTOR: Terraform
        GITHUB_ACTOR_EMAIL: fishwhack9000+terraform@gmail.com
        GPG_PRIVATE_KEY: ${{ inputs.GPG_PRIVATE_KEY }}
